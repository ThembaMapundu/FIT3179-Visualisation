{
  "$schema": "https://vega.github.io/schema/vega-lite/v5.json",
  "title": "Energy Production in Australia (2008â€“2023)",
  "width": 700,
  "height": 500,
  "data": {
    "url": "https://raw.githubusercontent.com/ThembaMapundu/FIT3179-Visualisation/refs/heads/main/Data/Energy_production_data.csv"
  },
  "config": {
    "view": {
      "stroke": null
    }
  },
  "transform": [
    {
      "fold": [
        "BLACK COAL", "BROWN COAL", "NATURAL GAS", "OIL PRODUCTS",
        "WIND", "HYDRO",
        "LARGE SCALE SOLAR PV", "SMALL SCALE SOLAR PV"
      ],
      "as": ["Energy_Source", "Energy_Value"]
    },
    {
      "calculate": "toNumber(datum.Energy_Value)",
      "as": "Energy_Value"
    },
    {
      "filter": "datum.Energy_Value != null && isFinite(datum.Energy_Value) && datum.Energy_Value > 0"
    },
    {
      "calculate": "indexof(['BLACK COAL','BROWN COAL','NATURAL GAS','OIL PRODUCTS','WIND','HYDRO','LARGE SCALE SOLAR PV','SMALL SCALE SOLAR PV'], datum.Energy_Source) >= 0 ? datum.Energy_Source : 'Other'",
      "as": "Grouped_Energy_Source"
    },
    {
      "calculate": "trim(datum.STATE)",
      "as": "TrimmedState"
    },
    {
      "filter": "datum.TrimmedState == state_select && datum.Grouped_Energy_Source != 'Other'"
    }
  ],
  "params": [
    {
      "name": "state_select",
      "value": "Overall",
      "bind": {
        "input": "select",
        "options": [
          "Overall", "New South Wales", "Victoria", "Queensland",
          "Western Australia", "South Australia", "Tasmania", "Northern Territory"
        ],
        "name": "Select State: "
      }
    }
  ],
  "mark": "bar",
  "encoding": {
    "x": {
      "field": "YEAR", 
      "type": "ordinal", 
      "title": "Year", 
      "axis": {
        "labelAngle": -45,
        "grid": false,
        "domain": false,
        "ticks": false
      }
    },
    "y": {
      "aggregate": "sum",
      "field": "Energy_Value",
      "type": "quantitative",
      "title": "Energy Production (GWh)",
      "axis": {
        "grid": false,
        "domain": false,
        "ticks": false
      }
    },
    "color": {
      "field": "Grouped_Energy_Source",
      "type": "nominal",
      "title": "Energy Source",
      "scale": {
        "domain": ["BLACK COAL", "BROWN COAL", "NATURAL GAS", "HYDRO", "WIND"],
        "range": ["purple", "orange", "red", "blue", "green"]
      }
    },
    "tooltip": [
      {"field": "YEAR", "type": "ordinal"},
      {"field": "TrimmedState", "type": "nominal", "title": "State"},
      {"field": "Grouped_Energy_Source", "type": "nominal", "title": "Energy Source"},
      {
        "aggregate": "sum",
        "field": "Energy_Value",
        "type": "quantitative",
        "title": "GWh",
        "format": ".1f"
      }
    ]
  }
}
